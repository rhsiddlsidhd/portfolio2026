name: Claude Code Review # Trigger CI to refresh GitHub App permissions again

on:
  pull_request:
    types: [labeled]
    paths:
      # 1. 포함할 경로들
      - "packages/**"
      - "package.json"
      - "package-lock.json"
      - ".github/workflows/**"

      # 2. 위 경로 중에서 제외할 경로들
      - "!**/*.md"
      - "!**/*.test.ts"
      - "!**/*.test.tsx"
      - "!**/*.spec.ts"
      - "!**/*.spec.tsx"

jobs:
  claude-review-caller:
    if: github.event.label.name == 'claude-review'
    permissions:
      contents: read
      issues: write
      pull-requests: write
      id-token: write
    uses: rhsiddlsidhd/central-ops/.github/workflows/on-pull-request-claude-code-review.yml@main
    secrets:
      APP_ID: ${{ secrets.APP_ID }}
      APP_PRIVATE_KEY: ${{ secrets.APP_PRIVATE_KEY }}
      CLAUDE_CODE_OAUTH_TOKEN: ${{ secrets.CLAUDE_CODE_OAUTH_TOKEN }}
