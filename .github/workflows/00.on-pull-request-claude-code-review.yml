name: Claude Code Review # Trigger CI to refresh GitHub App permissions again

on:
  pull_request:
    types: [opened, synchronize]
    paths:
      # 1. 포함할 경로들
      - "src/**"
      - "next.config.ts"
      - "tsconfig.json"
      - "package.json"
      - "package-lock.json"
      - ".github/workflows/**"

      # 2. 위 경로 중에서 제외할 경로들
      # 반드시 포함할 경로 뒤에 와야 합니다.
      - "!**/*.md"
      - "!src/**/*.test.ts"
      - "!src/**/*.test.tsx"
      - "!src/**/*.spec.ts"
      - "!src/**/*.spec.tsx"

jobs:
  claude-review-caller:
    permissions:
      contents: read
      issues: write
      pull-requests: write
      id-token: write
    uses: rhsiddlsidhd/central-ops/.github/workflows/on-pull-request-claude-code-review.yml@main
    secrets:
      APP_ID: ${{ secrets.APP_ID }}
      APP_PRIVATE_KEY: ${{ secrets.APP_PRIVATE_KEY }}
      CLAUDE_CODE_OAUTH_TOKEN: ${{ secrets.CLAUDE_CODE_OAUTH_TOKEN }}
